(ns task-2.task-2-1_test
  (:require [clojure.test :refer :all]
            [task-2.common :refer :all]))

(deftest trapezoid-test
  (testing "Testing trapezoid f(x)=x")
  (is (= (trapezoid linear -10 10) 0.0))
  (is (= (trapezoid linear 0 10) 50.0))
  (is (= (trapezoid linear -10 0) -50.0))
  (testing "Testing trapezoid f(x)=x^2")
  (is (= (trapezoid parabola -10 10) 2000.0))
  (is (= (trapezoid parabola 0 10) 500.0))
  (is (= (trapezoid parabola -10 0) 500.0))
  (testing "Testing trapezoid f(x)=x^4 - 20x^2 + 3x + 1")
  (is (= (trapezoid polynomial -10 10) 160020.0))
  (is (= (trapezoid polynomial 0 10) 40160.0))
  (is (= (trapezoid polynomial -10 0) 39860.0)))

(deftest integral-test
  (testing "Testing memoized integral with f(x)=x")
  (is (= ((integral-mem linear 5) -10 10) 0.0))
  (is (= ((integral-mem linear 10) -10 10) 0.0))
  (is (= ((integral-mem linear 5) 0 10) 50.0))
  (is (= ((integral-mem linear 10) 0 10) 50.0))
  (is (= ((integral-mem linear 5) -10 0) -50.0))
  (is (= ((integral-mem linear 10) -10 0) -50.0))
  (testing "Testing memoized integral with f(x)=x^2")
  (is (= ((integral-mem parabola 5) -10 10) 750.0))
  (is (= ((integral-mem parabola 10) -10 10) 1000.0))
  (is (= ((integral-mem parabola 5) 0 10) 375.0))
  (is (= ((integral-mem parabola 10) 0 10) 500.0))
  (is (= ((integral-mem parabola 5) -10 0) 375.0))
  (is (= ((integral-mem parabola 10) -10 0) 500.0))
  (testing "Testing memoized integral with f(x)=x^4 - 20x^2 + 3x + 1")
  (is (= ((integral-mem polynomial 5) -10 10) 41270.0))
  (is (= ((integral-mem polynomial 10) -10 10) 80020.0))
  (is (= ((integral-mem polynomial 5) 0 10) 20785.0))
  (is (= ((integral-mem polynomial 10) 0 10) 40160.0))
  (is (= ((integral-mem polynomial 5) -10 0) 20485.0))
  (is (= ((integral-mem polynomial 10) -10 0) 39860.0)))
